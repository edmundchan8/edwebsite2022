<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use Illuminate\Support\Facades\DB;
use Illuminate\View\Middleware\ShareErrorsFromSession;
//set up logging of errors
use Illuminate\Support\Facades\Log;

class StockDataController extends Controller
{
    public function index()
    {
        // current stocks I own, obtained from database and with foreach loop
        $stocks = DB::table('stock_data')
        -> select('tickersymbol')
        -> get();

        $new_arr = [];
        foreach(json_decode($stocks) as $key => $value){
            array_push($new_arr, $value->tickersymbol);
        }

        // current stocks I own as a single string
        $ticker_stock_str = implode(",", $new_arr);

        
        $stock_table_columns = ['symbol', 'twoHundredDayAverage', 'dividendDate', 'fiftyDayAverage', 'regularMarketPrice', 'forwardPE', 
        'lastDividendValue', 'recommendationMean', 'recommendationKey'];

        $API_KEY = env('APP_API_KEY');

        //loop through and get api data of each stock of our $ticker_stock_str
        $stock_url = "https://yahoo-finance15.p.rapidapi.com/api/yahoo/qu/quote/" . $ticker_stock_str;

            // Initiate the curl request
        $ch = curl_init();//$stock_url);

        // BEGIN API CALL
        $json = null;

        curl_setopt_array($ch, [
            CURLOPT_URL => $stock_url,
            CURLOPT_SSL_VERIFYPEER => 0,
            CURLOPT_RETURNTRANSFER => true,
            CURLOPT_FOLLOWLOCATION => true,
            CURLOPT_ENCODING => "",
            CURLOPT_MAXREDIRS => 10,
            CURLOPT_TIMEOUT => 30,
            CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,
            CURLOPT_CUSTOMREQUEST => "GET",
            CURLOPT_HTTPHEADER => [
                "X-RapidAPI-Key: " . $API_KEY,
                "X-RapidAPI-Host: yahoo-finance15.p.rapidapi.com",
                "content-type: application/x-www-form-urlencoded"
            ],
        ]);

        

        // send the request and get a bool response from it
        $response = curl_exec($ch);
        sleep(1);
        //capture any errors if exec above fails
        $err = curl_error($ch);
        // close the session and free up resources
        curl_close($ch);

        $stock_data_array = null;

        if ($err){
            echo 'cURL Error #:' . $err;
        }
        else{
            //$json should return all stocks, each as an array
            $json = json_decode($response, true);
        }
        
        // END OF API CALL

        // BEGIN WORKING ON $JSON DATA TO GET STOCK INFO

                // if data exists, set stock_data_array
                // if (array_key_exists('data', $json)){
                //     $stock_data_array = $json['data'];
                // }
                // else {
                //     // 'data' doesn't exists in $json, output message to see why
                //     Log::Error($json['message']);
                //     return $json;
                // }

        foreach ($json['body'] as $key => $stock_data){
          if (isset($stock_data['symbol'])){
            Log::info($stock_data);
            $current_stock_symbol = $stock_data['symbol'];
            
            if (in_array($current_stock_symbol, $new_arr)){
              $quote_array = $stock_data;

              $forwardPE = null;
              $trailingDivRate = null;
              $recommendationMean = 'null';
              $recommendationKey = 'null';
              $dividendDate = null;
              $fiftyDateAverage = null;

              // if below quotes don't exist, set to null
              isset($quote_array['forwardPE']) ? $forwardPE = $quote_array['forwardPE'] : '';
              isset($quote_array['trailingAnnualDividendRate']) ? $trailingDivRate = $quote_array['trailingAnnualDividendRate'] : '';
              isset($quote_array['dividendDate']) ? $dividendDate = $quote_array['dividendDate'] : '';
              isset($quote_array['fiftyDayAverage']) ? $fiftyDateAverage = $quote_array['fiftyDayAverage'] : '';
              

              // set recommendationMean to null, or if available split rating and buy/sell/hold value out
              // isset($quote_array['recommendationMean']) ? $recommendationMean = $quote_array['recommendationMean'] : '';

              // set recommendationKey rating to null, or if available split rating and buy/sell/hold value out
              // isset($quote_array['recommendationKey']) ? $recommendationKey = $quote_array['recommendationKey'] : '';


              //recommendationKey
              $stock_data_table = DB::table('stock_data');
              
              if ($stock_data_table->where('tickerSymbol', $quote_array['symbol'])->exists()){
                  $current_stock = $stock_data_table->where('tickerSymbol', $quote_array['symbol'])->first();
                  $stock_data_table
                      ->where('id', $current_stock->id)
                      ->limit(1)
                      ->update([
                      'tickerSymbol' => $quote_array['symbol'],
                      'twoHundredDayAverage' => $quote_array['twoHundredDayAverage'],
                      'price' => $quote_array['regularMarketPrice'],
                      'forwardPE' => $forwardPE,
                      'dividendRate' => $trailingDivRate,
                      'dividendDate' => $dividendDate,
                      'fiftyDayAverage' => $fiftyDateAverage,
                      // 'analystRating' => $recommendationMean,
                      // 'analystOpinion' => $recommendationKey,
                      'created_at' => date('Y-m-d H:i:s')
                  ]);
              }
              // what is this else for? EC - 2023-11-08
              else{
                  $stock_data_table
                      ->insert([
                      'tickerSymbol' => $quote_array['symbol'],
                      'twoHundredDayAverage' => $quote_array['twoHundredDayAverage'],
                      'price' => $quote_array['regularMarketPrice'],
                      'forwardPE' => $forwardPE,
                      'dividendRate' => $trailingDivRate,
                      'dividendDate' => $dividendDate,
                      'fiftyDayAverage' => $fiftyDateAverage,
                      // 'analystRating' => $recommendationMean,
                      // 'analystOpinion' => $recommendationKey,
                      'created_at' => date('Y-m-d H:i:s')
                  ]);
              }

            }

          }
          
        }
        
        return "Stocks Updated!";// view('data.index');
    }

    public function getTestBefore(){
      return 'before';
    }

    public function updateIncomeData(Request $request){
        
      // delete data
      // DB::table('stock_data')
      //     -> where('tickersymbol', $request->stock)
      //     -> update(['incomeStatement' => '[]']);
      // return;

      // get model for the stock data incomeStatement only
      $stock_income_statement = DB::table('stock_data')
          -> where('tickersymbol', $request->stock)
          -> first(['incomeStatement'])->incomeStatement;

      $output_json = [];

      // make sure incomeStatement is not null, otherwise create the new incomeStatement json
      if (!is_null($stock_income_statement)){
          $output_json[$request->stock] = [];
          $output_json = $output_json;
      } else {
          $output_json = $stock_income_statement;
      }

      // holds returned JSON data
      $json = $this->getTestData();//$this.getIncomeDataAPI();

      // Log::info($json);
      // return;

      //update stock_data table with api data
      $stock_table = DB::table('stock_data')
      -> where('tickersymbol', $request->stock)
      -> limit(1)
      -> update(['incomeStatement' => $json]);

      // return;

      $json_quarterly = $json['incomeStatementHistoryQuarterly']['incomeStatementHistory'];

      $json_quarterly = $json['incomeStatementHistoryQuarterly']['incomeStatementHistory'];
      $json_history = $json['incomeStatementHistory']['incomeStatementHistory'];

      $stock_income_data = array_merge($json_quarterly, $json_history);

      $new_output_json = $output_json;

      foreach($stock_income_data as $key => $data){

          $date = $stock_income_data[$key]['endDate']['fmt'];
          
          // only add the income statement if $date doesn't exists in decoded_output json
          if (!array_key_exists($date, $new_output_json[$request->stock])){
              // build grossProfit and SBC data array
              $profit_compensation_data = [];
              $profit_compensation_data['grossProfit'] = $stock_income_data[$key]['grossProfit']['raw'];
              $profit_compensation_data['stockCompensation'] = $stock_income_data[$key]['netIncomeApplicableToCommonShares']['raw'];

              // set grossProfit and stockCompensation data => date
              $new_output_json[$request->stock][$date] = $profit_compensation_data;
          }

      }

      $new_output_json = json_encode($new_output_json);

      
      if ($new_output_json !== $output_json){
          //then we will add and update the database
          
          $stock_table = DB::table('stock_data')
              -> where('tickersymbol', $request->stock)
              -> limit(1)
              -> update(['incomeStatement' => $new_output_json]);


      }

      return "income statement updated!";//$output_json;
  }

    public function getIncomeData(Request $request){
        $income_data = DB::table('stock_data')
            -> where('tickersymbol', $request->stock)
            ->get();

        return $income_data;
    }

    /** Adding a new stock to the database */
    public function addStockToDatabase(Request $request){

        $validated = $request->validate([
            'name' => 'required',
            'tickersymbol' => 'required',
            'price' => 'required',
            'twoHundredDayAverage' => 'required',
            'forwardPE' => 'required',
            'dividendRate' => 'required'
        ]);
        
        $tickersymbol = $request->tickersymbol;
        $name = $request->name;

        DB::table('stock_data')->insert(
            [
                'name' =>$name, 'tickersymbol' => $tickersymbol, 'price' => $request->price,
                'twoHundredDayAverage' => $request->twoHundredDayAverage,
                'forwardPE' => $request->forwardPE, 'dividendRate' => $request->dividendRate,
                'incomeStatement' => json_encode($request->incomeStatement)
            ]
        );

        echo "Stock added successfully!";
    }

    public function deleteStockDatabase(Request $request){
      Log::info($request);
      DB::table('stock_data')->where('id', '=', $request->id)->delete();
    }

    public function getIncomeDataAPI(){
      $API_KEY = env('APP_API_KEY');

      $stock_url = "https://macrotrends-finance.p.rapidapi.com/statements/cash?symbol=" . $request->stock . "&freq=Q&formstyle=dataframe";

      // Initiate the curl request
      $ch = curl_init();

      // BEGIN API CALL

      curl_setopt_array($ch, [
          CURLOPT_URL => $stock_url,
          CURLOPT_SSL_VERIFYPEER => 0,
          CURLOPT_RETURNTRANSFER => true,
          CURLOPT_FOLLOWLOCATION => true,
          CURLOPT_ENCODING => "",
          CURLOPT_MAXREDIRS => 10,
          CURLOPT_TIMEOUT => 30,
          CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,
          CURLOPT_CUSTOMREQUEST => "GET",
          CURLOPT_HTTPHEADER => [
              "X-RapidAPI-Key: " . $API_KEY,
              "X-RapidAPI-Host: macrotrends-finance.p.rapidapi.com",
              "content-type: application/x-www-form-urlencoded"
          ],
      ]);

      // send the request and get a bool response from it
      $response = curl_exec($ch);
      sleep(1);
      //capture any errors if exec above fails
      $err = curl_error($ch);
      // close the session and free up resources
      curl_close($ch);

      $stock_data_array = null;

      if ($err){
          echo 'cURL Error #:' . $err;
          return null;
      }
      else{
          //$json should return all stocks, each as an array
          return json_decode($response, true);
      }
    }

    // function to return test api data
    public function getTestData(){
      return '{
        "Net-Income/Loss": {
          "2023-03-31": 24160000000,
          "2022-12-31": 29998000000,
          "2022-09-30": 20721000000,
          "2022-06-30": 19442000000,
          "2022-03-31": 25010000000,
          "2021-12-31": 34630000000,
          "2021-09-30": 20551000000,
          "2021-06-30": 21744000000,
          "2021-03-31": 23630000000,
          "2020-12-31": 28755000000,
          "2020-09-30": 12673000000,
          "2020-06-30": 11253000000,
          "2020-03-31": 11249000000,
          "2019-12-31": 22236000000,
          "2019-09-30": 13686000000,
          "2019-06-30": 10044000000,
          "2019-03-31": 11561000000,
          "2018-12-31": 19965000000,
          "2018-09-30": 14125000000,
          "2018-06-30": 11519000000,
          "2018-03-31": 13822000000,
          "2017-12-31": 20065000000,
          "2017-09-30": 10714000000,
          "2017-06-30": 8717000000,
          "2017-03-31": 11029000000,
          "2016-12-31": 17891000000,
          "2016-09-30": 9014000000,
          "2016-06-30": 7796000000,
          "2016-03-31": 10516000000,
          "2015-12-31": 18361000000,
          "2015-09-30": 11124000000,
          "2015-06-30": 10677000000,
          "2015-03-31": 13569000000,
          "2014-12-31": 18024000000,
          "2014-09-30": 8467000000,
          "2014-06-30": 7748000000,
          "2014-03-31": 10223000000,
          "2013-12-31": 13072000000,
          "2013-09-30": 7512000000,
          "2013-06-30": 6900000000,
          "2013-03-31": 9547000000,
          "2012-12-31": 13078000000,
          "2012-09-30": 8223000000,
          "2012-06-30": 8824000000,
          "2012-03-31": 11622000000,
          "2011-12-31": 13064000000,
          "2011-09-30": 6623000000,
          "2011-06-30": 7308000000,
          "2011-03-31": 5987000000,
          "2010-12-31": 6004000000,
          "2010-09-30": 4308000000,
          "2010-06-30": 3253000000,
          "2010-03-31": 3074000000,
          "2009-12-31": 3378000000,
          "2009-09-30": 2532000000,
          "2009-06-30": 1828000000,
          "2009-03-31": 3875000000
        },
        "Total-Depreciation-And-Amortization---Cash-Flow": {
          "2023-03-31": 2898000000,
          "2022-12-31": 2916000000,
          "2022-09-30": 2865000000,
          "2022-06-30": 2805000000,
          "2022-03-31": 2737000000,
          "2021-12-31": 2697000000,
          "2021-09-30": 2989000000,
          "2021-06-30": 2832000000,
          "2021-03-31": 2797000000,
          "2020-12-31": 2666000000,
          "2020-09-30": 2702000000,
          "2020-06-30": 2752000000,
          "2020-03-31": 2786000000,
          "2019-12-31": 2816000000,
          "2019-09-30": 3179000000,
          "2019-06-30": 2933000000,
          "2019-03-31": 3040000000,
          "2018-12-31": 3395000000,
          "2018-09-30": 2754000000,
          "2018-06-30": 2665000000,
          "2018-03-31": 2739000000,
          "2017-12-31": 2745000000,
          "2017-09-30": 2484000000,
          "2017-06-30": 2354000000,
          "2017-03-31": 2332000000,
          "2016-12-31": 2987000000,
          "2016-09-30": 2548000000,
          "2016-06-30": 2526000000,
          "2016-03-31": 2477000000,
          "2015-12-31": 2954000000,
          "2015-09-30": 3119000000,
          "2015-06-30": 3084000000,
          "2015-03-31": 2479000000,
          "2014-12-31": 2575000000,
          "2014-09-30": 1969000000,
          "2014-06-30": 1946000000,
          "2014-03-31": 1887000000,
          "2013-12-31": 2144000000,
          "2013-09-30": 1783000000,
          "2013-06-30": 1694000000,
          "2013-03-31": 1692000000,
          "2012-12-31": 1588000000,
          "2012-09-30": 981000000,
          "2012-06-30": 835000000,
          "2012-03-31": 740000000,
          "2011-12-31": 721000000,
          "2011-09-30": 543000000,
          "2011-06-30": 481000000,
          "2011-03-31": 434000000,
          "2010-12-31": 356000000,
          "2010-09-30": 329000000,
          "2010-06-30": 273000000,
          "2010-03-31": 216000000,
          "2009-12-31": 209000000,
          "2009-09-30": 203000000,
          "2009-06-30": 182000000,
          "2009-03-31": 349000000
        },
        "Other-Non-Cash-Items": {
          "2023-03-31": 1271000000,
          "2022-12-31": 2588000000,
          "2022-09-30": 589000000,
          "2022-06-30": 3870000000,
          "2022-03-31": 2471000000,
          "2021-12-31": 3114000000,
          "2021-09-30": -1550000000,
          "2021-06-30": 1215000000,
          "2021-03-31": 1333000000,
          "2020-12-31": 1987000000,
          "2020-09-30": 1324000000,
          "2020-06-30": 2696000000,
          "2020-03-31": 1278000000,
          "2019-12-31": 1219000000,
          "2019-09-30": 885000000,
          "2019-06-30": 1457000000,
          "2019-03-31": 1176000000,
          "2018-12-31": 1558000000,
          "2018-09-30": 1830000000,
          "2018-06-30": 2218000000,
          "2018-03-31": 710000000,
          "2017-12-31": -32452000000,
          "2017-09-30": 2352000000,
          "2017-06-30": 3202000000,
          "2017-03-31": 2652000000,
          "2016-12-31": 2434000000,
          "2016-09-30": 844000000,
          "2016-06-30": 3264000000,
          "2016-03-31": 2746000000,
          "2015-12-31": 2780000000,
          "2015-09-30": -138000000,
          "2015-06-30": 1797000000,
          "2015-03-31": 609000000,
          "2014-12-31": 3085000000,
          "2014-09-30": -45000000,
          "2014-06-30": 1819000000,
          "2014-03-31": 1502000000,
          "2013-12-31": 1934000000,
          "2013-09-30": -828000000,
          "2013-06-30": 1145000000,
          "2013-03-31": 1353000000,
          "2012-12-31": 1724000000,
          "2012-09-30": 787000000,
          "2012-06-30": 1599000000,
          "2012-03-31": 1883000000,
          "2011-12-31": 1876000000,
          "2011-09-30": 934000000,
          "2011-06-30": 953000000,
          "2011-03-31": 1027000000,
          "2010-12-31": 1122000000,
          "2010-09-30": 366000000,
          "2010-06-30": 624000000,
          "2010-03-31": 699000000,
          "2009-12-31": 630000000,
          "2009-09-30": 430000000,
          "2009-06-30": 391000000,
          "2009-03-31": 929000000
        },
        "Total-Non-Cash-Items": {
          "2023-03-31": 4169000000,
          "2022-12-31": 5504000000,
          "2022-09-30": 3454000000,
          "2022-06-30": 6675000000,
          "2022-03-31": 5208000000,
          "2021-12-31": 5811000000,
          "2021-09-30": 1439000000,
          "2021-06-30": 4047000000,
          "2021-03-31": 4130000000,
          "2020-12-31": 4653000000,
          "2020-09-30": 4026000000,
          "2020-06-30": 5448000000,
          "2020-03-31": 4064000000,
          "2019-12-31": 4035000000,
          "2019-09-30": 4064000000,
          "2019-06-30": 4390000000,
          "2019-03-31": 4216000000,
          "2018-12-31": 4953000000,
          "2018-09-30": 4584000000,
          "2018-06-30": 4883000000,
          "2018-03-31": 3449000000,
          "2017-12-31": -29707000000,
          "2017-09-30": 4836000000,
          "2017-06-30": 5556000000,
          "2017-03-31": 4984000000,
          "2016-12-31": 5421000000,
          "2016-09-30": 3392000000,
          "2016-06-30": 5790000000,
          "2016-03-31": 5223000000,
          "2015-12-31": 5734000000,
          "2015-09-30": 2981000000,
          "2015-06-30": 4881000000,
          "2015-03-31": 3088000000,
          "2014-12-31": 5660000000,
          "2014-09-30": 1924000000,
          "2014-06-30": 3765000000,
          "2014-03-31": 3389000000,
          "2013-12-31": 4078000000,
          "2013-09-30": 955000000,
          "2013-06-30": 2839000000,
          "2013-03-31": 3045000000,
          "2012-12-31": 3312000000,
          "2012-09-30": 1768000000,
          "2012-06-30": 2434000000,
          "2012-03-31": 2623000000,
          "2011-12-31": 2597000000,
          "2011-09-30": 1477000000,
          "2011-06-30": 1434000000,
          "2011-03-31": 1461000000,
          "2010-12-31": 1478000000,
          "2010-09-30": 695000000,
          "2010-06-30": 897000000,
          "2010-03-31": 915000000,
          "2009-12-31": 839000000,
          "2009-09-30": 633000000,
          "2009-06-30": 573000000,
          "2009-03-31": 1278000000
        },
        "Change-In-Accounts-Receivable": {
          "2023-03-31": 5321000000,
          "2022-12-31": 4275000000,
          "2022-09-30": -6384000000,
          "2022-06-30": -981000000,
          "2022-03-31": 9476000000,
          "2021-12-31": -3934000000,
          "2021-09-30": -8809000000,
          "2021-06-30": 1031000000,
          "2021-03-31": 8598000000,
          "2020-12-31": -10945000000,
          "2020-09-30": 1768000000,
          "2020-06-30": -2135000000,
          "2020-03-31": 5269000000,
          "2019-12-31": 2015000000,
          "2019-09-30": -8768000000,
          "2019-06-30": 919000000,
          "2019-03-31": 2964000000,
          "2018-12-31": 5130000000,
          "2018-09-30": -9078000000,
          "2018-06-30": 233000000,
          "2018-03-31": 9093000000,
          "2017-12-31": -5570000000,
          "2017-09-30": -5474000000,
          "2017-06-30": -802000000,
          "2017-03-31": 2486000000,
          "2016-12-31": 1697000000,
          "2016-09-30": -4096000000,
          "2016-06-30": 85000000,
          "2016-03-31": 642000000,
          "2015-12-31": 3896000000,
          "2015-09-30": -6673000000,
          "2015-06-30": 535000000,
          "2015-03-31": 5804000000,
          "2014-12-31": 751000000,
          "2014-09-30": -6546000000,
          "2014-06-30": -1087000000,
          "2014-03-31": 4499000000,
          "2013-12-31": -1098000000,
          "2013-09-30": -4263000000,
          "2013-06-30": -1755000000,
          "2013-03-31": 4514000000,
          "2012-12-31": -668000000,
          "2012-09-30": -3273000000,
          "2012-06-30": -615000000,
          "2012-03-31": 1898000000,
          "2011-12-31": -3561000000,
          "2011-09-30": 735000000,
          "2011-06-30": -304000000,
          "2011-03-31": 229000000,
          "2010-12-31": -517000000,
          "2010-09-30": -2063000000,
          "2010-06-30": -561000000,
          "2010-03-31": 211000000,
          "2009-12-31": 271000000,
          "2009-09-30": -675000000,
          "2009-06-30": -754000000,
          "2009-03-31": 490000000
        },
        "Change-In-Inventories": {
          "2023-03-31": -741000000,
          "2022-12-31": -1807000000,
          "2022-09-30": 435000000,
          "2022-06-30": -16000000,
          "2022-03-31": 384000000,
          "2021-12-31": 681000000,
          "2021-09-30": -1429000000,
          "2021-06-30": 13000000,
          "2021-03-31": -276000000,
          "2020-12-31": -950000000,
          "2020-09-30": -137000000,
          "2020-06-30": -689000000,
          "2020-03-31": 727000000,
          "2019-12-31": -28000000,
          "2019-09-30": -785000000,
          "2019-06-30": 1502000000,
          "2019-03-31": 70000000,
          "2018-12-31": -1076000000,
          "2018-09-30": 1942000000,
          "2018-06-30": 1693000000,
          "2018-03-31": -3241000000,
          "2017-12-31": 434000000,
          "2017-09-30": -1709000000,
          "2017-06-30": -236000000,
          "2017-03-31": -198000000,
          "2016-12-31": -580000000,
          "2016-09-30": -301000000,
          "2016-06-30": 450000000,
          "2016-03-31": 170000000,
          "2015-12-31": -102000000,
          "2015-09-30": -307000000,
          "2015-06-30": 354000000,
          "2015-03-31": -113000000,
          "2014-12-31": -172000000,
          "2014-09-30": -246000000,
          "2014-06-30": 235000000,
          "2014-03-31": 293000000,
          "2013-12-31": -358000000,
          "2013-09-30": -67000000,
          "2013-06-30": -452000000,
          "2013-03-31": 210000000,
          "2012-12-31": -664000000,
          "2012-09-30": 331000000,
          "2012-06-30": -20000000,
          "2012-03-31": 134000000,
          "2011-12-31": -460000000,
          "2011-09-30": 113000000,
          "2011-06-30": 41000000,
          "2011-03-31": -45000000,
          "2010-12-31": 166000000,
          "2010-09-30": -109000000,
          "2010-06-30": -304000000,
          "2010-03-31": -62000000,
          "2009-12-31": -121000000,
          "2009-09-30": -75000000,
          "2009-06-30": -68000000,
          "2009-03-31": 197000000
        },
        "Change-In-Accounts-Payable": {
          "2023-03-31": -14689000000,
          "2022-12-31": -6075000000,
          "2022-09-30": 15556000000,
          "2022-06-30": -4358000000,
          "2022-03-31": -21563000000,
          "2021-12-31": 19813000000,
          "2021-09-30": 14112000000,
          "2021-06-30": 211000000,
          "2021-03-31": -23667000000,
          "2020-12-31": 21670000000,
          "2020-09-30": 6725000000,
          "2020-06-30": 2733000000,
          "2020-03-31": -12431000000,
          "2019-12-31": -1089000000,
          "2019-09-30": 17881000000,
          "2019-06-30": 220000000,
          "2019-03-31": -11523000000,
          "2018-12-31": -8501000000,
          "2018-09-30": 19585000000,
          "2018-06-30": 1594000000,
          "2018-03-31": -24606000000,
          "2017-12-31": 12602000000,
          "2017-09-30": 14178000000,
          "2017-06-30": 1650000000,
          "2017-03-31": -9322000000,
          "2016-12-31": 2460000000,
          "2016-09-30": 11684000000,
          "2016-06-30": -179000000,
          "2016-03-31": -8536000000,
          "2015-12-31": -852000000,
          "2015-09-30": 8264000000,
          "2015-06-30": 2165000000,
          "2015-03-31": -14431000000,
          "2014-12-31": 9003000000,
          "2014-09-30": 8469000000,
          "2014-06-30": -156000000,
          "2014-03-31": -10566000000,
          "2013-12-31": 8191000000,
          "2013-09-30": 7080000000,
          "2013-06-30": -318000000,
          "2013-03-31": -10567000000,
          "2012-12-31": 6145000000,
          "2012-09-30": 2017000000,
          "2012-06-30": -359000000,
          "2012-03-31": -1505000000,
          "2011-12-31": 4314000000,
          "2011-09-30": 35000000,
          "2011-06-30": 854000000,
          "2011-03-31": -720000000,
          "2010-12-31": 2346000000,
          "2010-09-30": 3495000000,
          "2010-06-30": 2830000000,
          "2010-03-31": -974000000,
          "2009-12-31": 956000000,
          "2009-09-30": 740000000,
          "2009-06-30": 879000000,
          "2009-03-31": -1527000000
        },
        "Change-In-Assets/Liabilities": {
          "2023-03-31": 10340000000,
          "2022-12-31": 2110000000,
          "2022-09-30": -9655000000,
          "2022-06-30": 2130000000,
          "2022-03-31": 9651000000,
          "2021-12-31": -10035000000,
          "2021-09-30": -5664000000,
          "2021-06-30": -5952000000,
          "2021-03-31": 11566000000,
          "2020-12-31": -4420000000,
          "2020-09-30": -4479000000,
          "2020-06-30": -339000000,
          "2020-03-31": 4433000000,
          "2019-12-31": 3347000000,
          "2019-09-30": -6168000000,
          "2019-06-30": -5439000000,
          "2019-03-31": 3867000000,
          "2018-12-31": 6219000000,
          "2018-09-30": -11635000000,
          "2018-06-30": -5434000000,
          "2018-03-31": 16613000000,
          "2017-12-31": 30469000000,
          "2017-09-30": -6796000000,
          "2017-06-30": -6213000000,
          "2017-03-31": 3591000000,
          "2016-12-31": 345000000,
          "2016-09-30": -3160000000,
          "2016-06-30": -3308000000,
          "2016-03-31": 3586000000,
          "2015-12-31": 426000000,
          "2015-09-30": -1914000000,
          "2015-06-30": -3624000000,
          "2015-03-31": 11164000000,
          "2014-12-31": 456000000,
          "2014-09-30": 1182000000,
          "2014-06-30": -250000000,
          "2014-03-31": 5700000000,
          "2013-12-31": -1215000000,
          "2013-09-30": -1309000000,
          "2013-06-30": 614000000,
          "2013-03-31": 5755000000,
          "2012-12-31": 2223000000,
          "2012-09-30": 70000000,
          "2012-06-30": -75000000,
          "2012-03-31": -795000000,
          "2011-12-31": 1600000000,
          "2011-09-30": 1446000000,
          "2011-06-30": 1775000000,
          "2011-03-31": -693000000,
          "2010-12-31": 296000000,
          "2010-09-30": -643000000,
          "2010-06-30": -1314000000,
          "2010-03-31": -834000000,
          "2009-12-31": 458000000,
          "2009-09-30": -45000000,
          "2009-06-30": -188000000,
          "2009-03-31": 466000000
        },
        "Total-Change-In-Assets/Liabilities": {
          "2023-03-31": 231000000,
          "2022-12-31": -1497000000,
          "2022-09-30": -48000000,
          "2022-06-30": -3225000000,
          "2022-03-31": -2052000000,
          "2021-12-31": 6525000000,
          "2021-09-30": -1790000000,
          "2021-06-30": -4697000000,
          "2021-03-31": -3779000000,
          "2020-12-31": 5355000000,
          "2020-09-30": 3877000000,
          "2020-06-30": -430000000,
          "2020-03-31": -2002000000,
          "2019-12-31": 4245000000,
          "2019-09-30": 2160000000,
          "2019-06-30": -2798000000,
          "2019-03-31": -4622000000,
          "2018-12-31": 1772000000,
          "2018-09-30": 814000000,
          "2018-06-30": -1914000000,
          "2018-03-31": -2141000000,
          "2017-12-31": 37935000000,
          "2017-09-30": 199000000,
          "2017-06-30": -5601000000,
          "2017-03-31": -3443000000,
          "2016-12-31": 3922000000,
          "2016-09-30": 4127000000,
          "2016-06-30": -2952000000,
          "2016-03-31": -4138000000,
          "2015-12-31": 3368000000,
          "2015-09-30": -630000000,
          "2015-06-30": -570000000,
          "2015-03-31": 2424000000,
          "2014-12-31": 10038000000,
          "2014-09-30": 2859000000,
          "2014-06-30": -1258000000,
          "2014-03-31": -74000000,
          "2013-12-31": 5520000000,
          "2013-09-30": 1441000000,
          "2013-06-30": -1911000000,
          "2013-03-31": -88000000,
          "2012-12-31": 7036000000,
          "2012-09-30": -855000000,
          "2012-06-30": -1069000000,
          "2012-03-31": -268000000,
          "2011-12-31": 1893000000,
          "2011-09-30": 2329000000,
          "2011-06-30": 2366000000,
          "2011-03-31": -1229000000,
          "2010-12-31": 2291000000,
          "2010-09-30": 680000000,
          "2010-06-30": 651000000,
          "2010-03-31": -1659000000,
          "2009-12-31": 1564000000,
          "2009-09-30": -55000000,
          "2009-06-30": -131000000,
          "2009-03-31": -374000000
        },
        "Cash-Flow-From-Operating-Activities": {
          "2023-03-31": 28560000000,
          "2022-12-31": 34005000000,
          "2022-09-30": 24127000000,
          "2022-06-30": 22892000000,
          "2022-03-31": 28166000000,
          "2021-12-31": 46966000000,
          "2021-09-30": 20200000000,
          "2021-06-30": 21094000000,
          "2021-03-31": 23981000000,
          "2020-12-31": 38763000000,
          "2020-09-30": 20576000000,
          "2020-06-30": 16271000000,
          "2020-03-31": 13311000000,
          "2019-12-31": 30516000000,
          "2019-09-30": 19910000000,
          "2019-06-30": 11636000000,
          "2019-03-31": 11155000000,
          "2018-12-31": 26690000000,
          "2018-09-30": 19523000000,
          "2018-06-30": 14488000000,
          "2018-03-31": 15130000000,
          "2017-12-31": 28293000000,
          "2017-09-30": 15749000000,
          "2017-06-30": 8672000000,
          "2017-03-31": 12570000000,
          "2016-12-31": 27234000000,
          "2016-09-30": 16533000000,
          "2016-06-30": 10634000000,
          "2016-03-31": 11601000000,
          "2015-12-31": 27463000000,
          "2015-09-30": 13475000000,
          "2015-06-30": 14988000000,
          "2015-03-31": 19081000000,
          "2014-12-31": 33722000000,
          "2014-09-30": 13250000000,
          "2014-06-30": 10255000000,
          "2014-03-31": 13538000000,
          "2013-12-31": 22670000000,
          "2013-09-30": 9908000000,
          "2013-06-30": 7828000000,
          "2013-03-31": 12504000000,
          "2012-12-31": 23426000000,
          "2012-09-30": 9136000000,
          "2012-06-30": 10189000000,
          "2012-03-31": 13977000000,
          "2011-12-31": 17554000000,
          "2011-09-30": 10429000000,
          "2011-06-30": 11108000000,
          "2011-03-31": 6219000000,
          "2010-12-31": 9773000000,
          "2010-09-30": 5683000000,
          "2010-06-30": 4801000000,
          "2010-03-31": 2330000000,
          "2009-12-31": 5781000000,
          "2009-09-30": 3110000000,
          "2009-06-30": 2270000000,
          "2009-03-31": 4779000000
        },
        "Net-Change-In-Property,-Plant,-And-Equipment": {
          "2023-03-31": -2916000000,
          "2022-12-31": -3787000000,
          "2022-09-30": -3289000000,
          "2022-06-30": -2102000000,
          "2022-03-31": -2514000000,
          "2021-12-31": -2803000000,
          "2021-09-30": -3223000000,
          "2021-06-30": -2093000000,
          "2021-03-31": -2269000000,
          "2020-12-31": -3500000000,
          "2020-09-30": -1784000000,
          "2020-06-30": -1565000000,
          "2020-03-31": -1853000000,
          "2019-12-31": -2107000000,
          "2019-09-30": -2777000000,
          "2019-06-30": -2000000000,
          "2019-03-31": -2363000000,
          "2018-12-31": -3355000000,
          "2018-09-30": -3041000000,
          "2018-06-30": -3267000000,
          "2018-03-31": -4195000000,
          "2017-12-31": -2810000000,
          "2017-09-30": -3865000000,
          "2017-06-30": -2277000000,
          "2017-03-31": -2975000000,
          "2016-12-31": -3334000000,
          "2016-09-30": -3977000000,
          "2016-06-30": -2809000000,
          "2016-03-31": -2336000000,
          "2015-12-31": -3612000000,
          "2015-09-30": -3618000000,
          "2015-06-30": -2043000000,
          "2015-03-31": -2369000000,
          "2014-12-31": -3217000000,
          "2014-09-30": -3826000000,
          "2014-06-30": -2378000000,
          "2014-03-31": -1382000000,
          "2013-12-31": -1985000000,
          "2013-09-30": -1955000000,
          "2013-06-30": -1885000000,
          "2013-03-31": -2008000000,
          "2012-12-31": -2317000000,
          "2012-09-30": -3461000000,
          "2012-06-30": -2056000000,
          "2012-03-31": -1457000000,
          "2011-12-31": -1321000000,
          "2011-09-30": -1645000000,
          "2011-06-30": -777000000,
          "2011-03-31": -624000000,
          "2010-12-31": -1214000000,
          "2010-09-30": -760000000,
          "2010-06-30": -595000000,
          "2010-03-31": -274000000,
          "2009-12-31": -376000000,
          "2009-09-30": -459000000,
          "2009-06-30": -246000000,
          "2009-03-31": -439000000
        },
        "Net-Change-In-Intangible-Assets": {
          "2023-03-31": 0,
          "2022-12-31": 0,
          "2022-09-30": 0,
          "2022-06-30": 0,
          "2022-03-31": 0,
          "2021-12-31": 0,
          "2021-09-30": 0,
          "2021-06-30": 0,
          "2021-03-31": 0,
          "2020-12-31": 0,
          "2020-09-30": 0,
          "2020-06-30": 0,
          "2020-03-31": 0,
          "2019-12-31": 0,
          "2019-09-30": 0,
          "2019-06-30": 0,
          "2019-03-31": 0,
          "2018-12-31": 0,
          "2018-09-30": 0,
          "2018-06-30": 0,
          "2018-03-31": 0,
          "2017-12-31": 0,
          "2017-09-30": 0,
          "2017-06-30": 0,
          "2017-03-31": 86000000,
          "2016-12-31": -86000000,
          "2016-09-30": 456000000,
          "2016-06-30": -96000000,
          "2016-03-31": -263000000,
          "2015-12-31": -394000000,
          "2015-09-30": -40000000,
          "2015-06-30": -46000000,
          "2015-03-31": -107000000,
          "2014-12-31": -48000000,
          "2014-09-30": -26000000,
          "2014-06-30": -53000000,
          "2014-03-31": -104000000,
          "2013-12-31": -59000000,
          "2013-09-30": -351000000,
          "2013-06-30": -131000000,
          "2013-03-31": -291000000,
          "2012-12-31": -138000000,
          "2012-09-30": -40000000,
          "2012-06-30": -907000000,
          "2012-03-31": -52000000,
          "2011-12-31": -108000000,
          "2011-09-30": -2926000000,
          "2011-06-30": -185000000,
          "2011-03-31": -32000000,
          "2010-12-31": -49000000,
          "2010-09-30": -53000000,
          "2010-06-30": -31000000,
          "2010-03-31": -27000000,
          "2009-12-31": -5000000,
          "2009-09-30": -13000000,
          "2009-06-30": -26000000,
          "2009-03-31": -30000000
        },
        "Net-Acquisitions/Divestitures": {
          "2023-03-31": 0,
          "2022-12-31": 0,
          "2022-09-30": -137000000,
          "2022-06-30": -169000000,
          "2022-03-31": 0,
          "2021-12-31": 0,
          "2021-09-30": -20000000,
          "2021-06-30": -4000000,
          "2021-03-31": -9000000,
          "2020-12-31": 0,
          "2020-09-30": -51000000,
          "2020-06-30": -339000000,
          "2020-03-31": -176000000,
          "2019-12-31": -958000000,
          "2019-09-30": -13000000,
          "2019-06-30": -320000000,
          "2019-03-31": -124000000,
          "2018-12-31": -167000000,
          "2018-09-30": -290000000,
          "2018-06-30": -126000000,
          "2018-03-31": -132000000,
          "2017-12-31": -173000000,
          "2017-09-30": -81000000,
          "2017-06-30": -181000000,
          "2017-03-31": -50000000,
          "2016-12-31": -17000000,
          "2016-09-30": 146000000,
          "2016-06-30": -6000000,
          "2016-03-31": -54000000,
          "2015-12-31": -86000000,
          "2015-09-30": -113000000,
          "2015-06-30": -115000000,
          "2015-03-31": -92000000,
          "2014-12-31": -23000000,
          "2014-09-30": -2867000000,
          "2014-06-30": -339000000,
          "2014-03-31": -34000000,
          "2013-12-31": -525000000,
          "2013-09-30": -53000000,
          "2013-06-30": -144000000,
          "2013-03-31": -15000000,
          "2012-12-31": -284000000,
          "2012-09-30": 0,
          "2012-06-30": 0,
          "2012-03-31": -350000000,
          "2011-12-31": 0,
          "2011-09-30": -244000000,
          "2011-06-30": 0,
          "2011-03-31": 0,
          "2010-12-31": 0,
          "2010-09-30": -23000000,
          "2010-06-30": -290000000,
          "2010-03-31": -325000000,
          "2009-12-31": 0,
          "2009-09-30": 0,
          "2009-06-30": 0,
          "2009-03-31": 0
        },
        "Net-Change-In-Short-term-Investments": {
          "2023-03-31": 5341000000,
          "2022-12-31": 2483000000,
          "2022-09-30": 2806000000,
          "2022-06-30": 6953000000,
          "2022-03-31": -6390000000,
          "2021-12-31": -12929000000,
          "2021-09-30": 4352000000,
          "2021-06-30": 5747000000,
          "2021-03-31": -7895000000,
          "2020-12-31": -5279000000,
          "2020-09-30": 7434000000,
          "2020-06-30": -2992000000,
          "2020-03-31": 11407000000,
          "2019-12-31": -10396000000,
          "2019-09-30": 3063000000,
          "2019-06-30": 28736000000,
          "2019-03-31": 15812000000,
          "2018-12-31": 9849000000,
          "2018-09-30": 592000000,
          "2018-06-30": 9394000000,
          "2018-03-31": 32800000000,
          "2017-12-31": -10423000000,
          "2017-09-30": -5460000000,
          "2017-06-30": -749000000,
          "2017-03-31": -11357000000,
          "2016-12-31": -15581000000,
          "2016-09-30": -3407000000,
          "2016-06-30": -184000000,
          "2016-03-31": -10983000000,
          "2015-12-31": -16060000000,
          "2015-09-30": 2556000000,
          "2015-06-30": -9245000000,
          "2015-03-31": -19786000000,
          "2014-12-31": -17942000000,
          "2014-09-30": 9707000000,
          "2014-06-30": -19474000000,
          "2014-03-31": 13289000000,
          "2013-12-31": -12539000000,
          "2013-09-30": 2942000000,
          "2013-06-30": -4252000000,
          "2013-03-31": -12002000000,
          "2012-12-31": -10730000000,
          "2012-09-30": -820000000,
          "2012-06-30": -9339000000,
          "2012-03-31": -12603000000,
          "2011-12-31": -15665000000,
          "2011-09-30": -8028000000,
          "2011-06-30": -14092000000,
          "2011-03-31": -901000000,
          "2010-12-31": -9443000000,
          "2010-09-30": -3563000000,
          "2010-06-30": -4468000000,
          "2010-03-31": 463000000,
          "2009-12-31": -3507000000,
          "2009-09-30": -3247000000,
          "2009-06-30": -1053000000,
          "2009-03-31": -11746000000
        },
        "Net-Change-In-Long-Term-Investments": {
          "2023-03-31": 0,
          "2022-12-31": 0,
          "2022-09-30": 0,
          "2022-06-30": 0,
          "2022-03-31": 0,
          "2021-12-31": 0,
          "2021-09-30": 0,
          "2021-06-30": 0,
          "2021-03-31": 0,
          "2020-12-31": 0,
          "2020-09-30": 0,
          "2020-06-30": 0,
          "2020-03-31": 0,
          "2019-12-31": 0,
          "2019-09-30": -261000000,
          "2019-06-30": 1384000000,
          "2019-03-31": -63000000,
          "2018-12-31": -427000000,
          "2018-09-30": -40000000,
          "2018-06-30": -1315000000,
          "2018-03-31": -22000000,
          "2017-12-31": -141000000,
          "2017-09-30": -308000000,
          "2017-06-30": -87000000,
          "2017-03-31": 0,
          "2016-12-31": 0,
          "2016-09-30": -12000000,
          "2016-06-30": -1250000000,
          "2016-03-31": 0,
          "2015-12-31": -126000000,
          "2015-09-30": 0,
          "2015-06-30": 0,
          "2015-03-31": 0,
          "2014-12-31": 0,
          "2014-09-30": -10000000,
          "2014-06-30": 0,
          "2014-03-31": 0,
          "2013-12-31": 0,
          "2013-09-30": 0,
          "2013-06-30": 0,
          "2013-03-31": 0,
          "2012-12-31": 0,
          "2012-09-30": 0,
          "2012-06-30": 0,
          "2012-03-31": 0,
          "2011-12-31": 0,
          "2011-09-30": 0,
          "2011-06-30": 0,
          "2011-03-31": 0,
          "2010-12-31": 0,
          "2010-09-30": 0,
          "2010-06-30": 0,
          "2010-03-31": 0,
          "2009-12-31": 0,
          "2009-09-30": 61000000,
          "2009-06-30": -7000000,
          "2009-03-31": -54000000
        },
        "Net-Change-In-Investments---Total": {
          "2023-03-31": 5341000000,
          "2022-12-31": 2483000000,
          "2022-09-30": 2806000000,
          "2022-06-30": 6953000000,
          "2022-03-31": -6390000000,
          "2021-12-31": -12929000000,
          "2021-09-30": 4352000000,
          "2021-06-30": 5747000000,
          "2021-03-31": -7895000000,
          "2020-12-31": -5279000000,
          "2020-09-30": 7434000000,
          "2020-06-30": -2992000000,
          "2020-03-31": 11407000000,
          "2019-12-31": -10396000000,
          "2019-09-30": 2802000000,
          "2019-06-30": 30120000000,
          "2019-03-31": 15749000000,
          "2018-12-31": 9422000000,
          "2018-09-30": 552000000,
          "2018-06-30": 8079000000,
          "2018-03-31": 32778000000,
          "2017-12-31": -10564000000,
          "2017-09-30": -5768000000,
          "2017-06-30": -836000000,
          "2017-03-31": -11357000000,
          "2016-12-31": -15581000000,
          "2016-09-30": -3419000000,
          "2016-06-30": -1434000000,
          "2016-03-31": -10983000000,
          "2015-12-31": -16186000000,
          "2015-09-30": 2556000000,
          "2015-06-30": -9245000000,
          "2015-03-31": -19786000000,
          "2014-12-31": -17942000000,
          "2014-09-30": 9697000000,
          "2014-06-30": -19474000000,
          "2014-03-31": 13289000000,
          "2013-12-31": -12539000000,
          "2013-09-30": 2942000000,
          "2013-06-30": -4252000000,
          "2013-03-31": -12002000000,
          "2012-12-31": -10730000000,
          "2012-09-30": -820000000,
          "2012-06-30": -9339000000,
          "2012-03-31": -12603000000,
          "2011-12-31": -15665000000,
          "2011-09-30": -8028000000,
          "2011-06-30": -14092000000,
          "2011-03-31": -901000000,
          "2010-12-31": -9443000000,
          "2010-09-30": -3563000000,
          "2010-06-30": -4468000000,
          "2010-03-31": 463000000,
          "2009-12-31": -3507000000,
          "2009-09-30": -3186000000,
          "2009-06-30": -1060000000,
          "2009-03-31": -11800000000
        },
        "Investing-Activities---Other": {
          "2023-03-31": -106000000,
          "2022-12-31": -141000000,
          "2022-09-30": -597000000,
          "2022-06-30": -448000000,
          "2022-03-31": -361000000,
          "2021-12-31": -374000000,
          "2021-09-30": -274000000,
          "2021-06-30": -78000000,
          "2021-03-31": -195000000,
          "2020-12-31": 195000000,
          "2020-09-30": -68000000,
          "2020-06-30": -269000000,
          "2020-03-31": -365000000,
          "2019-12-31": -207000000,
          "2019-09-30": -810000000,
          "2019-06-30": -298000000,
          "2019-03-31": 86000000,
          "2018-12-31": -56000000,
          "2018-09-30": -222000000,
          "2018-06-30": -739000000,
          "2018-03-31": 259000000,
          "2017-12-31": -43000000,
          "2017-09-30": -228000000,
          "2017-06-30": 114000000,
          "2017-03-31": 94000000,
          "2016-12-31": -104000000,
          "2016-09-30": -603000000,
          "2016-06-30": -125000000,
          "2016-03-31": -24000000,
          "2015-12-31": -172000000,
          "2015-09-30": -160000000,
          "2015-06-30": 46000000,
          "2015-03-31": 23000000,
          "2014-12-31": 65000000,
          "2014-09-30": 19000000,
          "2014-06-30": 30000000,
          "2014-03-31": -28000000,
          "2013-12-31": 5000000,
          "2013-09-30": 28000000,
          "2013-06-30": -95000000,
          "2013-03-31": -41000000,
          "2012-12-31": -52000000,
          "2012-09-30": 8000000,
          "2012-06-30": -8000000,
          "2012-03-31": -14000000,
          "2011-12-31": -34000000,
          "2011-09-30": -293000000,
          "2011-06-30": 22000000,
          "2011-03-31": 35000000,
          "2010-12-31": -23000000,
          "2010-09-30": 16000000,
          "2010-06-30": -46000000,
          "2010-03-31": 80000000,
          "2009-12-31": -70000000,
          "2009-09-30": -113000000,
          "2009-06-30": -7000000,
          "2009-03-31": -55000000
        },
        "Cash-Flow-From-Investing-Activities": {
          "2023-03-31": 2319000000,
          "2022-12-31": -1445000000,
          "2022-09-30": -1217000000,
          "2022-06-30": 4234000000,
          "2022-03-31": -9265000000,
          "2021-12-31": -16106000000,
          "2021-09-30": 835000000,
          "2021-06-30": 3572000000,
          "2021-03-31": -10368000000,
          "2020-12-31": -8584000000,
          "2020-09-30": 5531000000,
          "2020-06-30": -5165000000,
          "2020-03-31": 9013000000,
          "2019-12-31": -13668000000,
          "2019-09-30": -798000000,
          "2019-06-30": 27502000000,
          "2019-03-31": 13348000000,
          "2018-12-31": 5844000000,
          "2018-09-30": -3001000000,
          "2018-06-30": 3947000000,
          "2018-03-31": 28710000000,
          "2017-12-31": -13590000000,
          "2017-09-30": -9942000000,
          "2017-06-30": -3180000000,
          "2017-03-31": -14202000000,
          "2016-12-31": -19122000000,
          "2016-09-30": -7397000000,
          "2016-06-30": -4470000000,
          "2016-03-31": -13660000000,
          "2015-12-31": -20450000000,
          "2015-09-30": -1375000000,
          "2015-06-30": -11403000000,
          "2015-03-31": -22331000000,
          "2014-12-31": -21165000000,
          "2014-09-30": 2997000000,
          "2014-06-30": -22214000000,
          "2014-03-31": 11741000000,
          "2013-12-31": -15103000000,
          "2013-09-30": 611000000,
          "2013-06-30": -6507000000,
          "2013-03-31": -14357000000,
          "2012-12-31": -13521000000,
          "2012-09-30": -4313000000,
          "2012-06-30": -12310000000,
          "2012-03-31": -14476000000,
          "2011-12-31": -17128000000,
          "2011-09-30": -13136000000,
          "2011-06-30": -15032000000,
          "2011-03-31": -1522000000,
          "2010-12-31": -10729000000,
          "2010-09-30": -4383000000,
          "2010-06-30": -5430000000,
          "2010-03-31": -83000000,
          "2009-12-31": -3958000000,
          "2009-09-30": -3771000000,
          "2009-06-30": -1339000000,
          "2009-03-31": -12324000000
        },
        "Net-Long-Term-Debt": {
          "2023-03-31": -2250000000,
          "2022-12-31": -1401000000,
          "2022-09-30": 2672000000,
          "2022-06-30": -3000000000,
          "2022-03-31": -3750000000,
          "2021-12-31": 0,
          "2021-09-30": 5220000000,
          "2021-06-30": -3000000000,
          "2021-03-31": 10423000000,
          "2020-12-31": -1000000000,
          "2020-09-30": 291000000,
          "2020-06-30": 3655000000,
          "2020-03-31": -1694000000,
          "2019-12-31": 1210000000,
          "2019-09-30": 3658000000,
          "2019-06-30": -3000000000,
          "2019-03-31": -2500000000,
          "2018-12-31": 0,
          "2018-09-30": 0,
          "2018-06-30": -6000000000,
          "2018-03-31": -500000000,
          "2017-12-31": 6969000000,
          "2017-09-30": 6937000000,
          "2017-06-30": 7250000000,
          "2017-03-31": 10975000000,
          "2016-12-31": 0,
          "2016-09-30": 6970000000,
          "2016-06-30": -100000000,
          "2016-03-31": 15584000000,
          "2015-12-31": 0,
          "2015-09-30": 5802000000,
          "2015-06-30": 9980000000,
          "2015-03-31": 7847000000,
          "2014-12-31": 3485000000,
          "2014-09-30": 0,
          "2014-06-30": 11960000000,
          "2014-03-31": 0,
          "2013-12-31": 0,
          "2013-09-30": 0,
          "2013-06-30": 16896000000,
          "2013-03-31": 0,
          "2012-12-31": 0,
          "2012-09-30": 0,
          "2012-06-30": 0,
          "2012-03-31": 0,
          "2011-12-31": 0,
          "2011-09-30": 0,
          "2011-06-30": 0,
          "2011-03-31": 0,
          "2010-12-31": 0,
          "2010-09-30": 0,
          "2010-06-30": 0,
          "2010-03-31": 0,
          "2009-12-31": 0,
          "2009-09-30": 0,
          "2009-06-30": 0,
          "2009-03-31": 0
        },
        "Net-Current-Debt": {
          "2023-03-31": 254000000,
          "2022-12-31": -8214000000,
          "2022-09-30": -1015000000,
          "2022-06-30": 3971000000,
          "2022-03-31": 1999000000,
          "2021-12-31": -1000000000,
          "2021-09-30": -2000000000,
          "2021-06-30": 3000000000,
          "2021-03-31": 0,
          "2020-12-31": 22000000,
          "2020-09-30": -994000000,
          "2020-06-30": -1487000000,
          "2020-03-31": 2497000000,
          "2019-12-31": -979000000,
          "2019-09-30": -3951000000,
          "2019-06-30": -1990000000,
          "2019-03-31": -42000000,
          "2018-12-31": 6000000,
          "2018-09-30": -27000000,
          "2018-06-30": -10000000,
          "2018-03-31": -2000000,
          "2017-12-31": 2000000,
          "2017-09-30": -14000000,
          "2017-06-30": 1987000000,
          "2017-03-31": -506000000,
          "2016-12-31": 2385000000,
          "2016-09-30": -4389000000,
          "2016-06-30": 4495000000,
          "2016-03-31": 737000000,
          "2015-12-31": -1240000000,
          "2015-09-30": 3999000000,
          "2015-06-30": 700000000,
          "2015-03-31": -99000000,
          "2014-12-31": -2409000000,
          "2014-09-30": 4296000000,
          "2014-06-30": 2010000000,
          "2014-03-31": 0,
          "2013-12-31": 0,
          "2013-09-30": 0,
          "2013-06-30": 0,
          "2013-03-31": 0,
          "2012-12-31": 0,
          "2012-09-30": 0,
          "2012-06-30": 0,
          "2012-03-31": 0,
          "2011-12-31": 0,
          "2011-09-30": 0,
          "2011-06-30": 0,
          "2011-03-31": 0,
          "2010-12-31": 0,
          "2010-09-30": 0,
          "2010-06-30": 0,
          "2010-03-31": 0,
          "2009-12-31": 0,
          "2009-09-30": 0,
          "2009-06-30": 0,
          "2009-03-31": 0
        },
        "Debt-Issuance/Retirement-Net---Total": {
          "2023-03-31": -1996000000,
          "2022-12-31": -9615000000,
          "2022-09-30": 1657000000,
          "2022-06-30": 971000000,
          "2022-03-31": -1751000000,
          "2021-12-31": -1000000000,
          "2021-09-30": 3220000000,
          "2021-06-30": 0,
          "2021-03-31": 10423000000,
          "2020-12-31": -978000000,
          "2020-09-30": -703000000,
          "2020-06-30": 2168000000,
          "2020-03-31": 803000000,
          "2019-12-31": 231000000,
          "2019-09-30": -293000000,
          "2019-06-30": -4990000000,
          "2019-03-31": -2542000000,
          "2018-12-31": 6000000,
          "2018-09-30": -27000000,
          "2018-06-30": -6010000000,
          "2018-03-31": -502000000,
          "2017-12-31": 6971000000,
          "2017-09-30": 6923000000,
          "2017-06-30": 9237000000,
          "2017-03-31": 10469000000,
          "2016-12-31": 2385000000,
          "2016-09-30": 2581000000,
          "2016-06-30": 4395000000,
          "2016-03-31": 16321000000,
          "2015-12-31": -1240000000,
          "2015-09-30": 9801000000,
          "2015-06-30": 10680000000,
          "2015-03-31": 7748000000,
          "2014-12-31": 1076000000,
          "2014-09-30": 4296000000,
          "2014-06-30": 13970000000,
          "2014-03-31": 0,
          "2013-12-31": 0,
          "2013-09-30": 0,
          "2013-06-30": 16896000000,
          "2013-03-31": 0,
          "2012-12-31": 0,
          "2012-09-30": 0,
          "2012-06-30": 0,
          "2012-03-31": 0,
          "2011-12-31": 0,
          "2011-09-30": 0,
          "2011-06-30": 0,
          "2011-03-31": 0,
          "2010-12-31": 0,
          "2010-09-30": 0,
          "2010-06-30": 0,
          "2010-03-31": 0,
          "2009-12-31": 0,
          "2009-09-30": 0,
          "2009-06-30": 0,
          "2009-03-31": 0
        },
        "Net-Common-Equity-Issued/Repurchased": {
          "2023-03-31": -19594000000,
          "2022-12-31": -19475000000,
          "2022-09-30": -24428000000,
          "2022-06-30": -21865000000,
          "2022-03-31": -22631000000,
          "2021-12-31": -20478000000,
          "2021-09-30": -19748000000,
          "2021-06-30": -22900000000,
          "2021-03-31": -18548000000,
          "2020-12-31": -24775000000,
          "2020-09-30": -17617000000,
          "2020-06-30": -15891000000,
          "2020-03-31": -18146000000,
          "2019-12-31": -20704000000,
          "2019-09-30": -17054000000,
          "2019-06-30": -16954000000,
          "2019-03-31": -23312000000,
          "2018-12-31": -8796000000,
          "2018-09-30": -18763000000,
          "2018-06-30": -20782000000,
          "2018-03-31": -22429000000,
          "2017-12-31": -10095000000,
          "2017-09-30": -7514000000,
          "2017-06-30": -7092000000,
          "2017-03-31": -6888000000,
          "2016-12-31": -10851000000,
          "2016-09-30": -7348000000,
          "2016-06-30": -10166000000,
          "2016-03-31": -6421000000,
          "2015-12-31": -6862000000,
          "2015-09-30": -13034000000,
          "2015-06-30": -9985000000,
          "2015-03-31": -6741000000,
          "2014-12-31": -4950000000,
          "2014-09-30": -16705000000,
          "2014-06-30": -4906000000,
          "2014-03-31": -17764000000,
          "2013-12-31": -4895000000,
          "2013-09-30": -4715000000,
          "2013-06-30": -15940000000,
          "2013-03-31": 199000000,
          "2012-12-31": -1874000000,
          "2012-09-30": 232000000,
          "2012-06-30": 56000000,
          "2012-03-31": 286000000,
          "2011-12-31": 91000000,
          "2011-09-30": 254000000,
          "2011-06-30": 83000000,
          "2011-03-31": 286000000,
          "2010-12-31": 208000000,
          "2010-09-30": 179000000,
          "2010-06-30": 199000000,
          "2010-03-31": 160000000,
          "2009-12-31": 374000000,
          "2009-09-30": 187000000,
          "2009-06-30": 166000000,
          "2009-03-31": 122000000
        },
        "Net-Total-Equity-Issued/Repurchased": {
          "2023-03-31": -19594000000,
          "2022-12-31": -19475000000,
          "2022-09-30": -24428000000,
          "2022-06-30": -21865000000,
          "2022-03-31": -22631000000,
          "2021-12-31": -20478000000,
          "2021-09-30": -19748000000,
          "2021-06-30": -22900000000,
          "2021-03-31": -18548000000,
          "2020-12-31": -24775000000,
          "2020-09-30": -17617000000,
          "2020-06-30": -15891000000,
          "2020-03-31": -18146000000,
          "2019-12-31": -20704000000,
          "2019-09-30": -17054000000,
          "2019-06-30": -16954000000,
          "2019-03-31": -23312000000,
          "2018-12-31": -8796000000,
          "2018-09-30": -18763000000,
          "2018-06-30": -20782000000,
          "2018-03-31": -22429000000,
          "2017-12-31": -10095000000,
          "2017-09-30": -7514000000,
          "2017-06-30": -7092000000,
          "2017-03-31": -6888000000,
          "2016-12-31": -10851000000,
          "2016-09-30": -7348000000,
          "2016-06-30": -10166000000,
          "2016-03-31": -6421000000,
          "2015-12-31": -6862000000,
          "2015-09-30": -13034000000,
          "2015-06-30": -9985000000,
          "2015-03-31": -6741000000,
          "2014-12-31": -4950000000,
          "2014-09-30": -16705000000,
          "2014-06-30": -4906000000,
          "2014-03-31": -17764000000,
          "2013-12-31": -4895000000,
          "2013-09-30": -4715000000,
          "2013-06-30": -15940000000,
          "2013-03-31": 199000000,
          "2012-12-31": -1874000000,
          "2012-09-30": 232000000,
          "2012-06-30": 56000000,
          "2012-03-31": 286000000,
          "2011-12-31": 91000000,
          "2011-09-30": 254000000,
          "2011-06-30": 83000000,
          "2011-03-31": 286000000,
          "2010-12-31": 208000000,
          "2010-09-30": 179000000,
          "2010-06-30": 199000000,
          "2010-03-31": 160000000,
          "2009-12-31": 374000000,
          "2009-09-30": 187000000,
          "2009-06-30": 166000000,
          "2009-03-31": 122000000
        },
        "Total-Common-And-Preferred-Stock-Dividends-Paid": {
          "2023-03-31": -3650000000,
          "2022-12-31": -3768000000,
          "2022-09-30": -3703000000,
          "2022-06-30": -3811000000,
          "2022-03-31": -3595000000,
          "2021-12-31": -3732000000,
          "2021-09-30": -3640000000,
          "2021-06-30": -3767000000,
          "2021-03-31": -3447000000,
          "2020-12-31": -3613000000,
          "2020-09-30": -3511000000,
          "2020-06-30": -3656000000,
          "2020-03-31": -3375000000,
          "2019-12-31": -3539000000,
          "2019-09-30": -3479000000,
          "2019-06-30": -3629000000,
          "2019-03-31": -3443000000,
          "2018-12-31": -3568000000,
          "2018-09-30": -3530000000,
          "2018-06-30": -3653000000,
          "2018-03-31": -3190000000,
          "2017-12-31": -3339000000,
          "2017-09-30": -3270000000,
          "2017-06-30": -3365000000,
          "2017-03-31": -3004000000,
          "2016-12-31": -3130000000,
          "2016-09-30": -3092000000,
          "2016-06-30": -3187000000,
          "2016-03-31": -2902000000,
          "2015-12-31": -2969000000,
          "2015-09-30": -2964000000,
          "2015-06-30": -3053000000,
          "2015-03-31": -2743000000,
          "2014-12-31": -2801000000,
          "2014-09-30": -2829000000,
          "2014-06-30": -2867000000,
          "2014-03-31": -2661000000,
          "2013-12-31": -2769000000,
          "2013-09-30": -2769000000,
          "2013-06-30": -2811000000,
          "2013-03-31": -2491000000,
          "2012-12-31": -2493000000,
          "2012-09-30": -2488000000,
          "2012-06-30": 0,
          "2012-03-31": 0,
          "2011-12-31": 0,
          "2011-09-30": 0,
          "2011-06-30": 0,
          "2011-03-31": 0,
          "2010-12-31": 0,
          "2010-09-30": 0,
          "2010-06-30": 0,
          "2010-03-31": 0,
          "2009-12-31": 0,
          "2009-09-30": 0,
          "2009-06-30": 0,
          "2009-03-31": 0
        },
        "Financial-Activities---Other": {
          "2023-03-31": -484000000,
          "2022-12-31": -2705000000,
          "2022-09-30": -320000000,
          "2022-06-30": -2740000000,
          "2022-03-31": -374000000,
          "2021-12-31": -2949000000,
          "2021-09-30": -214000000,
          "2021-06-30": -2729000000,
          "2021-03-31": 246000000,
          "2020-12-31": -2883000000,
          "2020-09-30": 474000000,
          "2020-06-30": -1737000000,
          "2020-03-31": -222000000,
          "2019-12-31": -1395000000,
          "2019-09-30": -213000000,
          "2019-06-30": -1231000000,
          "2019-03-31": -160000000,
          "2018-12-31": -1318000000,
          "2018-09-30": -260000000,
          "2018-06-30": -1078000000,
          "2018-03-31": -151000000,
          "2017-12-31": -1038000000,
          "2017-09-30": -228000000,
          "2017-06-30": -858000000,
          "2017-03-31": -159000000,
          "2016-12-31": -629000000,
          "2016-09-30": 970000000,
          "2016-06-30": -483000000,
          "2016-03-31": -114000000,
          "2015-12-31": -373000000,
          "2015-09-30": -102000000,
          "2015-06-30": -397000000,
          "2015-03-31": -3000000,
          "2014-12-31": -248000000,
          "2014-09-30": -142000000,
          "2014-06-30": -210000000,
          "2014-03-31": 18000000,
          "2013-12-31": -85000000,
          "2013-09-30": -24000000,
          "2013-06-30": -271000000,
          "2013-03-31": 44000000,
          "2012-12-31": -130000000,
          "2012-09-30": 234000000,
          "2012-06-30": -111000000,
          "2012-03-31": 24000000,
          "2011-12-31": -22000000,
          "2011-09-30": 177000000,
          "2011-06-30": -46000000,
          "2011-03-31": 261000000,
          "2010-12-31": 221000000,
          "2010-09-30": 77000000,
          "2010-06-30": 117000000,
          "2010-03-31": 2000000,
          "2009-12-31": 149000000,
          "2009-09-30": 132000000,
          "2009-06-30": 42000000,
          "2009-03-31": 14000000
        },
        "Cash-Flow-From-Financial-Activities": {
          "2023-03-31": -25724000000,
          "2022-12-31": -35563000000,
          "2022-09-30": -26794000000,
          "2022-06-30": -27445000000,
          "2022-03-31": -28351000000,
          "2021-12-31": -28159000000,
          "2021-09-30": -20382000000,
          "2021-06-30": -29396000000,
          "2021-03-31": -11326000000,
          "2020-12-31": -32249000000,
          "2020-09-30": -21357000000,
          "2020-06-30": -19116000000,
          "2020-03-31": -20940000000,
          "2019-12-31": -25407000000,
          "2019-09-30": -21039000000,
          "2019-06-30": -26804000000,
          "2019-03-31": -29457000000,
          "2018-12-31": -13676000000,
          "2018-09-30": -22580000000,
          "2018-06-30": -31523000000,
          "2018-03-31": -26272000000,
          "2017-12-31": -7501000000,
          "2017-09-30": -4089000000,
          "2017-06-30": -2078000000,
          "2017-03-31": 418000000,
          "2016-12-31": -12225000000,
          "2016-09-30": -6889000000,
          "2016-06-30": -9441000000,
          "2016-03-31": 6884000000,
          "2015-12-31": -11444000000,
          "2015-09-30": -6299000000,
          "2015-06-30": -2755000000,
          "2015-03-31": -1739000000,
          "2014-12-31": -6923000000,
          "2014-09-30": -15380000000,
          "2014-06-30": 5987000000,
          "2014-03-31": -20407000000,
          "2013-12-31": -7749000000,
          "2013-09-30": -7508000000,
          "2013-06-30": -2126000000,
          "2013-03-31": -2248000000,
          "2012-12-31": -4497000000,
          "2012-09-30": -2022000000,
          "2012-06-30": -55000000,
          "2012-03-31": 310000000,
          "2011-12-31": 69000000,
          "2011-09-30": 431000000,
          "2011-06-30": 37000000,
          "2011-03-31": 547000000,
          "2010-12-31": 429000000,
          "2010-09-30": 256000000,
          "2010-06-30": 316000000,
          "2010-03-31": 162000000,
          "2009-12-31": 523000000,
          "2009-09-30": 319000000,
          "2009-06-30": 208000000,
          "2009-03-31": 136000000
        },
        "Net-Cash-Flow": {
          "2023-03-31": 5155000000,
          "2022-12-31": -3003000000,
          "2022-09-30": -3884000000,
          "2022-06-30": -319000000,
          "2022-03-31": -9450000000,
          "2021-12-31": 2701000000,
          "2021-09-30": 653000000,
          "2021-06-30": -4730000000,
          "2021-03-31": 2287000000,
          "2020-12-31": -2070000000,
          "2020-09-30": 4750000000,
          "2020-06-30": -8010000000,
          "2020-03-31": 1384000000,
          "2019-12-31": -8559000000,
          "2019-09-30": -1927000000,
          "2019-06-30": 12334000000,
          "2019-03-31": -4954000000,
          "2018-12-31": 18858000000,
          "2018-09-30": -6058000000,
          "2018-06-30": -13088000000,
          "2018-03-31": 17568000000,
          "2017-12-31": 7202000000,
          "2017-09-30": 1718000000,
          "2017-06-30": 3414000000,
          "2017-03-31": -1214000000,
          "2016-12-31": -4113000000,
          "2016-09-30": 2247000000,
          "2016-06-30": -3277000000,
          "2016-03-31": 4825000000,
          "2015-12-31": -4431000000,
          "2015-09-30": 5801000000,
          "2015-06-30": 830000000,
          "2015-03-31": -4989000000,
          "2014-12-31": 5634000000,
          "2014-09-30": 867000000,
          "2014-06-30": -5972000000,
          "2014-03-31": 4872000000,
          "2013-12-31": -182000000,
          "2013-09-30": 3011000000,
          "2013-06-30": -805000000,
          "2013-03-31": -4101000000,
          "2012-12-31": 5408000000,
          "2012-09-30": 2801000000,
          "2012-06-30": -2176000000,
          "2012-03-31": -189000000,
          "2011-12-31": 495000000,
          "2011-09-30": -2276000000,
          "2011-06-30": -3887000000,
          "2011-03-31": 5244000000,
          "2010-12-31": -527000000,
          "2010-09-30": 1556000000,
          "2010-06-30": -313000000,
          "2010-03-31": 2409000000,
          "2009-12-31": 2346000000,
          "2009-09-30": -342000000,
          "2009-06-30": 1139000000,
          "2009-03-31": -7409000000
        },
        "Stock-Based-Compensation": {
          "2023-03-31": 2686000000,
          "2022-12-31": 2905000000,
          "2022-09-30": 2278000000,
          "2022-06-30": 2243000000,
          "2022-03-31": 2252000000,
          "2021-12-31": 2265000000,
          "2021-09-30": 1945000000,
          "2021-06-30": 1960000000,
          "2021-03-31": 1981000000,
          "2020-12-31": 2020000000,
          "2020-09-30": 1724000000,
          "2020-06-30": 1698000000,
          "2020-03-31": 1697000000,
          "2019-12-31": 1710000000,
          "2019-09-30": 1499000000,
          "2019-06-30": 1496000000,
          "2019-03-31": 1514000000,
          "2018-12-31": 1559000000,
          "2018-09-30": 1345000000,
          "2018-06-30": 1351000000,
          "2018-03-31": 1348000000,
          "2017-12-31": 1296000000,
          "2017-09-30": 1174000000,
          "2017-06-30": 1193000000,
          "2017-03-31": 1217000000,
          "2016-12-31": 1256000000,
          "2016-09-30": 1030000000,
          "2016-06-30": 1054000000,
          "2016-03-31": 1048000000,
          "2015-12-31": 1078000000,
          "2015-09-30": 915000000,
          "2015-06-30": 856000000,
          "2015-03-31": 927000000,
          "2014-12-31": 888000000,
          "2014-09-30": 762000000,
          "2014-06-30": 724000000,
          "2014-03-31": 696000000,
          "2013-12-31": 681000000,
          "2013-09-30": 555000000,
          "2013-06-30": 578000000,
          "2013-03-31": 575000000,
          "2012-12-31": 545000000,
          "2012-09-30": 448000000,
          "2012-06-30": 448000000,
          "2012-03-31": 424000000,
          "2011-12-31": 420000000,
          "2011-09-30": 298000000,
          "2011-06-30": 284000000,
          "2011-03-31": 287000000,
          "2010-12-31": 299000000,
          "2010-09-30": 224000000,
          "2010-06-30": 219000000,
          "2010-03-31": 231000000,
          "2009-12-31": 205000000,
          "2009-09-30": 180000000,
          "2009-06-30": 179000000,
          "2009-03-31": 351000000
        },
        "Common-Stock-Dividends-Paid": {
          "2023-03-31": -3650000000,
          "2022-12-31": -3768000000,
          "2022-09-30": -3703000000,
          "2022-06-30": -3811000000,
          "2022-03-31": -3595000000,
          "2021-12-31": -3732000000,
          "2021-09-30": -3640000000,
          "2021-06-30": -3767000000,
          "2021-03-31": -3447000000,
          "2020-12-31": -3613000000,
          "2020-09-30": -3511000000,
          "2020-06-30": -3656000000,
          "2020-03-31": -3375000000,
          "2019-12-31": -3539000000,
          "2019-09-30": -3479000000,
          "2019-06-30": -3629000000,
          "2019-03-31": -3443000000,
          "2018-12-31": -3568000000,
          "2018-09-30": -3530000000,
          "2018-06-30": -3653000000,
          "2018-03-31": -3190000000,
          "2017-12-31": -3339000000,
          "2017-09-30": -3270000000,
          "2017-06-30": -3365000000,
          "2017-03-31": -3004000000,
          "2016-12-31": -3130000000,
          "2016-09-30": -3092000000,
          "2016-06-30": -3187000000,
          "2016-03-31": -2902000000,
          "2015-12-31": -2969000000,
          "2015-09-30": -2964000000,
          "2015-06-30": -3053000000,
          "2015-03-31": -2743000000,
          "2014-12-31": -2801000000,
          "2014-09-30": -2829000000,
          "2014-06-30": -2867000000,
          "2014-03-31": -2661000000,
          "2013-12-31": -2769000000,
          "2013-09-30": -2769000000,
          "2013-06-30": -2811000000,
          "2013-03-31": -2491000000,
          "2012-12-31": -2493000000,
          "2012-09-30": -2488000000,
          "2012-06-30": 0,
          "2012-03-31": 0,
          "2011-12-31": 0,
          "2011-09-30": 0,
          "2011-06-30": 0,
          "2011-03-31": 0,
          "2010-12-31": 0,
          "2010-09-30": 0,
          "2010-06-30": 0,
          "2010-03-31": 0,
          "2009-12-31": 0,
          "2009-09-30": 0,
          "2009-06-30": 0,
          "2009-03-31": 0
        }
      }';
    }
}
